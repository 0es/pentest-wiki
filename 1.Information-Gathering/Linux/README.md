
# Information Gathering - Linux

## System Architecture

|**Command**|**Description**|
|:----------|:--------------|
|uname -a|The **uname** command reports basic information about a computer's software and hardware.|
|cat /etc/issue|The file **/etc/issue** is a text file which contains a message or system identification to be printed before the login prompt.|
|cat /etc/*-release|**/etc/lsb-release**, **/etc/redhat-release** files contain a description line which is parsed to get information. ex: "Distributor release x.x (Codename)"|
|cat /proc/version|**/proc/version** specifies the version of the Linux kernel, the version of gcc used to compile the kernel, and the time of kernel compilation. It also contains the kernel compiler's user name.|
|cat /proc/sys/kernel/version|The files in **/proc/sys/kernel/** can be used to tune and monitor miscellaneous and general things in the operation of the Linux kernel. [**Kernel - Documentation**](https://www.kernel.org/doc/Documentation/sysctl/kernel.txt)|


## Processes

|**Command**|**Description**|
|:----------|:--------------|
|ps -ef<BR>ps aux|**ps** can report a snapshot of the current processes.|
|top|**top** command displays processor activity of your Linux box and also displays tasks managed by kernel in real-time. It'll show processor and memory are being used and other information like running processes.|
|ls -al /proc/|**/proc** is very special in that it is also a virtual filesystem. It's sometimes referred to as a process information pseudo-file system. It doesn't contain 'real' files but runtime system information (e.g. system memory, devices mounted, hardware configuration, etc). |
|ls -al /proc/3080|View information about PID **3080**.|

## Users and Groups

|**Command**|**Description**|
|:----------|:--------------|
|id||
|w||
|whoami||
|lastlog||
|cat /etc/passwd||
|cat /etc/shadow||
|cat /etc/master.passwd||
|cat /etc/sudoers||
|sudo -V||
|cat ~/.ssh/authorized_keys||
|cat ~/.ssh/identity.pub||
|cat ~/.ssh/identity||
|cat ~/.ssh/id_rsa.pub||
|cat ~/.ssh/id_rsa||
|cat ~/.ssh/id_dsa.pub||
|cat ~/.ssh/id_dsa||
|cat /etc/ssh/ssh_config||
|cat /etc/ssh/sshd_config||
|cat /etc/ssh/ssh_host_dsa_key.pub||
|cat /etc/ssh/ssh_host_dsa_key||
|cat /etc/ssh/ssh_host_rsa_key.pub||
|cat /etc/ssh/ssh_host_rsa_key||
|cat /etc/ssh/ssh_host_key.pub||
|cat /etc/ssh/ssh_host_key||

## Services

|**Command**|**Description**|
|:----------|:--------------|
|service -status-all||
|systemctl -a||
|service `servicename` start<BR>systemctl start `servicename`||
|service `servicename` stop<BR>systemctl stop `servicename`||
|service `servicename` status<BR>systemctl status `servicename`||
|cat /etc/service||

## Security

|**Command**|**Description**|
|:----------|:--------------|
|iptables -L||
|iptables -F||
|iptables -A INPUT -p icmp -m icmp --icmp-type 0 -j ACCEPT||
|iptables -A INPUT -p tcp -m tcp --sport 80 -m state --state RELATED,ESTABLISHED -j ACCEPT||
|iptables -A OUTPUT -p tcp -m tcp --dport 80 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT||
|iptables -A INPUT -p udp -m udp --sport 53 -m state --state RELATED,ESTABLISHED -j ACCEPT||
|iptables -A OUTPUT -p udp -m udp --dport 53 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT||
|iptables -A OUTPUT -p tcp -m tcp --sport 55552 -s 127.0.0.1 -d 127.0.0.1 -j ACCEPT<BR>iptables -A OUTPUT -p tcp -m tcp --dport 55552 -s 127.0.0.1 -d 127.0.0.1 -j ACCEPT||

## Networking

|**Command**|**Description**|
|:----------|:--------------|
|ifconfig -a||
|hostname||
|dnsdomainname||
|netstat -antp||
|netstat -anup||
|chkconfig --list||
|lsof -nPi||
|route -e||
|iwconfig||
|cat /etc/resolv.conf||
|cat /etc/hosts||
|cat /etc/network/interfaces||
|cat /etc/sysconfig/network||
|cat /etc/networks||
|cat /proc/net/tcp||
|cat /proc/net/udp||
|cat /proc/net/icmp||
|cat /proc/net/route||
|cat /etc/inetd.conf||
|cat /etc/xinetd.conf||
|ls -R /etc/network/||
|ls -al /etc/init.d||
|iptables -L||
|iptables -L -t nat||
|iptables -L -t mangle||
|tcpdump|tcpdump cheat sheet|
|nc -v `host` `port`||
|nc -v -e /bin/sh -l -p `port`||

## File Systems

|**Command**|**Description**|
|:----------|:--------------|
|cat /etc/profile||
|cat /etc/bashrc||
|cat ~/.bash_profile||
|car ~/.bash_history|
|cat ~/.bashrc||
|car ~/.zshrc|
|cat ~/.bash_logout||
|ls -al /var/log/||
|find / -perm -1000 -type d 2>/dev/null | Sticky bit - Only the owner of the directory or the owner of a file can delete or rename here.|
|find / -perm -g=s -type f 2>/dev/null | SGID (chmod 2000) - run as the group, not the user who started it.|
|find / -perm -u=s -type f 2>/dev/null  | SUID (chmod 4000) - run as the owner, not the user who started it.|
|find / -perm -g=s -o -perm -u=s -type f 2>/dev/null | SGID or SUID|
|for i in `locate -r "bin$"`; do find $i \( -perm -4000 -o -perm -2000 \) -type f 2>/dev/null; done | Looks in 'common' places: /bin, /sbin, /usr/bin, /usr/sbin, /usr/local/bin, /usr/local/sbin and any other *bin, for SGID or SUID (Quicker search)|
|find / -perm -g=s -o -perm -4000 ! -type l -maxdepth 3 -exec ls -ld {} \; 2>/dev/null|find starting at root (/), SGID or SUID, not Symbolic links, only 3 folders deep, list with more detail and hide any errors (e.g. permission denied)|
|find / -writable -type d 2>/dev/null| world-writeable folders|
|find / -perm -222 -type d 2>/dev/null|world-writeable folders|
|find / -perm -o w -type d 2>/dev/null| world-writeable folders|
|find / -perm -o x -type d 2>/dev/null|world-executable folders|
|find / \( -perm -o w -perm -o x \) -type d 2>/dev/null | world-writeable & executable folders|
|find / -xdev -type d \( -perm -0002 -a ! -perm -1000 \) -print|world-writeable files|
|find /dir -xdev \( -nouser -o -nogroup \) -print|Noowner files|

## Scheduled

|**Command**|**Description**|
|:----------|:--------------|
|crontab -l||
|ls -alh /var/spool/cron||
|ls -al /etc/cron*||
|cat /etc/cron*||
|cat /etc/at.allow||
|cat /etc/at.deny||
|cat /etc/cron.allow||
|cat /etc/cron.deny||
|cat /etc/crontab||
|cat /etc/anacrontab||
|ls -la /var/spool/cron/crontabs||
|cat /var/spool/cron/crontabs/root||


# Links

1. https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/
2. https://github.com/CISOfy/lynis
3. https://github.com/rebootuser/LinEnum
4. https://github.com/nixawk/metasploit-modules/blob/master/.msf4/modules/post/linux/gather/enum_linux.rb
5. http://www.iptables.org/documentation/
4. http://packetlife.net/media/library/12/tcpdump.pdf
